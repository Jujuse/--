# Імпортуємо модуль для роботи з JSON
import json

# Початкові дані про учнів та їх оцінки
students = [
    {"Прізвище": "Іванов", "Оцінки": [5, 4, 3, 4, 5]},
    {"Прізвище": "Петров", "Оцінки": [3, 3, 4, 4, 3]},
    {"Прізвище": "Сидоров", "Оцінки": [5, 5, 5, 5, 5]}
]

# 1. Зберігаємо дані у JSON файл
with open("учні.json", "w", encoding="utf-8") as file:
    json.dump(students, file, ensure_ascii=False, indent=4)
print("Дані збережено у файлі 'учні.json'")

# 2. Функція для виведення даних
def показати_дані():
    try:
        with open("учні.json", "r", encoding="utf-8") as file:
            дані = json.load(file)
            print("\nСписок учнів:")
            for учень in дані:
                print(f"{учень['Прізвище']}: {учень['Оцінки']} (Сума: {sum(учень['Оцінки'])})")
    except FileNotFoundError:
        print("Файл не знайдено!")

# 3. Функція для додавання учня
def додати_учня():
    прізвище = input("Введіть прізвище учня: ")
    оцінки = input("Введіть 5 оцінок через пробіл: ").split()
    
    # Перевіряємо, чи введено 5 оцінок
    if len(оцінки) != 5:
        print("Потрібно ввести рівно 5 оцінок!")
        return
    
    # Перетворюємо оцінки в числа
    try:
        оцінки = list(map(int, оцінки))
    except ValueError:
        print("Оцінки повинні бути числами!")
        return
    
    новий_учень = {"Прізвище": прізвище, "Оцінки": оцінки}
    
    try:
        # Читаємо існуючі дані
        with open("учні.json", "r", encoding="utf-8") as file:
            дані = json.load(file)
        
        # Додаємо нового учня
        дані.append(новий_учень)
        
        # Зберігаємо оновлені дані
        with open("учні.json", "w", encoding="utf-8") as file:
            json.dump(дані, file, ensure_ascii=False, indent=4)
        
        print(f"Учень {прізвище} успішно доданий!")
    except FileNotFoundError:
        print("Файл не знайдено!")

# 4. Функція для пошуку учня
def знайти_учня():
    прізвище = input("Введіть прізвище учня для пошуку: ")
    
    try:
        with open("учні.json", "r", encoding="utf-8") as file:
            дані = json.load(file)
        
        знайдено = False
        for учень in дані:
            if учень["Прізвище"].lower() == прізвище.lower():
                print(f"\nРезультат пошуку:")
                print(f"Прізвище: {учень['Прізвище']}")
                print(f"Оцінки: {учень['Оцінки']}")
                print(f"Сума оцінок: {sum(учень['Оцінки'])}")
                знайдено = True
                break
        
        if not знайдено:
            print("Учень не знайдений!")
    except FileNotFoundError:
        print("Файл не знайдено!")

# 5. Функція для аналізу оцінок
def аналіз_оцінок():
    try:
        with open("учні.json", "r", encoding="utf-8") as file:
            дані = json.load(file)
        
        if not дані:
            print("Немає даних для аналізу!")
            return
        
        # Знаходимо учня з найвищою сумою оцінок
        учень_max = max(дані, key=lambda x: sum(x["Оцінки"]))
        
        # Знаходимо учня з найнижчою сумою оцінок
        учень_min = min(дані, key=lambda x: sum(x["Оцінки"]))
        
        print("\nРезультати аналізу:")
        print(f"Найкращий учень: {учень_max['Прізвище']} (сума: {sum(учень_max['Оцінки'])})")
        print(f"Найгірший учень: {учень_min['Прізвище']} (сума: {sum(учень_min['Оцінки'])})")
        
        # Зберігаємо результати
        результати = {
            "Найкращий_учень": учень_max["Прізвище"],
            "Найгірший_учень": учень_min["Прізвище"],
            "Різниця": sum(учень_max["Оцінки"]) - sum(учень_min["Оцінки"])
        }
        
        with open("результати.json", "w", encoding="utf-8") as file:
            json.dump(результати, file, ensure_ascii=False, indent=4)
        
        print("Результати збережено у файлі 'результати.json'")
    except FileNotFoundError:
        print("Файл не знайдено!")

# Головне меню
while True:
    print("\nОберіть дію:")
    print("1. Показати список учнів")
    print("2. Додати нового учня")
    print("3. Знайти учня за прізвищем")
    print("4. Проаналізувати оцінки")
    print("5. Вийти")
    
    вибір = input("Ваш вибір (1-5): ")
    
    if вибір == "1":
        показати_дані()
    elif вибір == "2":
        додати_учня()
    elif вибір == "3":
        знайти_учня()
    elif вибір == "4":
        аналіз_оцінок()
    elif вибір == "5":
        print("До побачення!")
        break
    else:
        print("Невірний вибір. Спробуйте ще раз.")